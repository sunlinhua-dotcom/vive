(function(){"use strict";self.onmessage=async n=>{const{file:i,maxWidth:t,quality:c}=n.data;try{const s=await createImageBitmap(i);let{width:e,height:a}=s;e>a?e>t&&(a=Math.round(a*t/e),e=t):a>t&&(e=Math.round(e*t/a),a=t);const o=new OffscreenCanvas(e,a);o.getContext("2d").drawImage(s,0,0,e,a);const l=await o.convertToBlob({type:"image/jpeg",quality:c||.7}),r=new FileReader;r.onloadend=()=>{self.postMessage({base64:r.result})},r.onerror=()=>{self.postMessage({error:"FileReader failed in worker"})},r.readAsDataURL(l)}catch(s){self.postMessage({error:s.message})}}})();
